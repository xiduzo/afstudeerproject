<section>
    <md-tabs md-dynamic-height md-border-bottom class="md-primary">
        <md-tab ng-repeat="guild in guildOverviewCtrl.guilds">

            <md-tab-label>
                {{ guild.name }}
            </md-tab-label>

            <md-tab-body>
                <section layout-margin layout="row">
                    <md-content flex="60" layout="row" class="md-whiteframe-z2">
                        <div id="{{guild.id}}" style="height: 300px;" flex="100"></div>
                    </md-content>
                    <md-content style="height: 300px;" flex="40" layout="column" class="md-whiteframe-z2">
                        <md-toolbar>
                            <h1 layout-padding class="md-title">
                                Latest news
                            </h1>
                        </md-toolbar>
                        <md-list>
                            <md-list-item ng-repeat="update in guild.history_updates | orderBy: '-created_at' | limitTo: 4">
                                <span flex>
                                    {{ update.action }}
                                </span>
                                <span>
                                    {{ update.created_at | date : 'dd/MM @ HH:mm' }}
                                </span>
                            </md-list-item>
                        </md-list>
                    </md-content>
                </section>

                <section layout-margin layout="row">
                    <h2 class="md-title" flex>
                        Objectives
                    </h2>
                    <md-button class="md-raised md-accent md-fab" ng-click="guildOverviewCtrl.addObjective(guild)">
                        <md-icon md-svg-icon="add_light"></md-icon>
                        <md-tooltip md-direction="left">
                            Add objective
                        </md-tooltip>
                    </md-button>
                </section>

                <section layout-margin layout="row">
                    <section ng-if="guild.objectives.length < 1">
                        No objectives have been set for this guild yet.
                    </section>


                    <md-content flex="100" ng-if="guild.objectives.length" class="md-whiteframe-z2">
                        <md-toolbar layout="row" layout-padding>
                            <span flex="10" layout-padding>
                                Completed
                            </span>
                            <span flex="20" layout-padding>
                                Name
                            </span>
                            <span flex="50" layout-padding>
                                Objective
                            </span>
                            <span flex="10" layout-padding>
                                Points
                            </span>
                            <span flex="10" layout-padding>
                                <!-- placeholder -->
                            </span>
                        </md-toolbar>
                        <md-list>
                            <md-list-item layout="row"
                                ng-repeat="objective in guild.objectives | orderBy: ['completed', '-created_at']">
                                <span flex="10" layout-padding>
                                    <md-checkbox ng-model="objective.completed"
                                        aria-label="Toggle status"
                                        ng-click="guildOverviewCtrl.updateStatus(guild, objective)">
                                    </md-checkbox>
                                </span>
                                <span flex="20" layout-padding>
                                    {{ objective.name }}
                                </span>
                                <span flex="50" layout-padding>
                                    {{ objective.objective }}
                                </span>
                                <span flex="10" layout-padding>
                                    {{ objective.points | number  }}
                                </span>
                                <span flex="10" layout-padding>
                                    <md-button class="md-icon-button"
                                        ng-click="guildOverviewCtrl.removeObjective(guild, objective)">
                                        <md-icon md-svg-icon="delete_dark">
                                            <md-tooltip>
                                                Remove objective
                                            </md-tooltip>
                                        </md-icon>
                                    </md-button>
                                </span>
                            </md-list-item>
                        </md-list>
                    </md-content>
                </section>

            </md-tab-body>

        </md-tab>
    </md-tabs>
</section>
